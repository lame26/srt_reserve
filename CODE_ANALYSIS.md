# SRT 간편예매 자동화 코드 분석

## 1) 코드 목적
- `uiautomator2`로 안드로이드 에뮬레이터(`emulator-5554`)에 연결한 뒤,
- SRT 앱의 **간편예매 화면**에서 `열차 예약하기` 버튼을 반복 클릭하여,
- `잔여석없음` 팝업이면 닫고 즉시 재시도,
- 화면 전환이 감지되면 성공 가능성으로 판단하고 사용자에게 수동 결제를 안내한다.

## 2) 동작 흐름
1. `u2.connect(DEVICE_ADDR)`로 디바이스 연결
2. 사용자 수동 준비 확인(`input`) 대기
3. 무한 루프에서 예약 버튼 탐색/클릭
4. 결과 분기
   - `잔여석없음` 텍스트 감지: 확인 버튼 클릭 후 반복
   - 여전히 같은 화면(예약 버튼 존재): 재시도
   - 화면 전환: 성공 가능성 알림 후 종료
5. 예외 발생 시 에러 출력 후 반복

## 3) 강점
- 구현이 단순하여 장애 지점이 적고 즉시 사용 가능
- `content-desc`와 텍스트 기반 탐색을 병행해 기본적인 UI 변화에 대응
- 실패 시 종료하지 않고 반복 시도하므로 잔여석 경쟁 시나리오에 적합

## 4) 한계/리스크
- UI 문자열(`열차 예약하기`, `잔여석없음`, `확인`)에 강하게 의존함
- 화면 전환만으로 성공 판정하여, 실패 화면 전환도 오탐지할 수 있음
- 재시도 간격 고정(`sleep`)으로 너무 빠르거나 느릴 수 있음
- 예외 로깅이 단순 문자열 수준이라 원인 추적이 어려움
- 디바이스 주소가 상수로 고정되어 다중/실기기 환경 대응이 어려움

## 5) 개선 제안
- 성공 판정 강화: 결제/승차권 확인 화면의 특정 selector를 추가 검증
- 설정값 분리: 디바이스 주소, timeout, retry interval을 CLI 인자로 분리
- 로깅 개선: 시도 횟수, 예외 타입, 타임스탬프를 구조화 로그로 기록
- 안전장치: 최대 재시도, 지정 종료 시각, 인터럽트 처리(`KeyboardInterrupt`) 추가
- 진단 기능: 실패 시 스크린샷 저장으로 문제 상황 재현성 확보
